var util = require("util");
var url = require("url");
var apiKey;
var baseURL = "https://api.server-eye.de";
var apiVersion = 1;

function getAPIUrl() {
    var args = [];
    for(var i = 0; i < arguments.length; i++){
        if(util.isString(arguments[i]) || util.isNumber(arguments[i])){
            args.push(arguments[i]);
        }
    }
    var path = args.join('/');
    console.log(arguments);
    var urlObj = url.parse([baseURL,apiVersion,path].join("/"));
    return urlObj;
}

function apiCB(deferred, err, res, body) {
    if (!err) {
        if (body.success) {
            deferred.resolve(body.data);
        } else {
            deferred.reject(body.message);
        }
    } else {
        deferred.reject(err);
    }
}

(function ($) {
    $.getAPIUrl = getAPIUrl;
    $.apiCB = apiCB;
    $.setAPIkey = function (key) {
        if (typeof key === "string" && key.length) {

            apiKey = key;
            return apiKey;
        } else {
            return undefined;
        }
    };
    $.getAPIkey = function () {
        return apiKey;
    };
    $.isObject = util.isObject;
    $.isArray = util.isArray;
    $.isString = util.isString;
    $.isBoolean = util.isBoolean;
    $.isNumber = util.isNumber;
    $.isDate = util.isDate;
})(exports);
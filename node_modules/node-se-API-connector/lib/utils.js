var url = require('url');
var apiKey;
var baseURL = "https://api.server-eye.de/";
var apiVersion = 1;

function getAPIUrl(path) {
    var urlObj = url.parse(baseURL + apiVersion + path);
    return urlObj;
}

function apiCB(deferred, err, res, body) {
    if (!err) {
        if (body.success) {
            deferred.resolve(body.data);
        } else {
            deferred.reject(body.message);
        }
    } else {
        deferred.reject(err);
    }
}

(function ($) {
    $.getAPIUrl = getAPIUrl;
    $.apiCB = apiCB;
    $.setAPIkey = function (key) {
        if (typeof key === "string" && key.length) {

            apiKey = key;
            return apiKey;
        } else {
            return undefined;
        }
    };
    $.getAPIkey = function () {
        return apiKey;
    };
})(exports);